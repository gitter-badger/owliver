{
	"always_mismatch":{"not":{}},

	"pointer":
	{
		"title":"pointer",
		"type":"string",
		"pattern":"^file\\: *([A-Za-z0-9_\\-][ A-Za-z0-9_\\-/]*\\.json)$"
	},

	"tag_list":
	{
		"type":"array",
		"items":
		{
			"type":"string",
			"pattern":"^[a-zA-Z0-9_]+$"
		}
	},

	"mcq_option":
	{
		"oneOf":
		[
			{"type":"string"},
			{
				"type":"object",
				"properties":
				{
					"title":{"type":"string"},
					"text":{"type":"string"},
					"is_correct":{"type":"boolean"}
				},
				"required":["text"]
			}
		]
	},

	"mcq_options_list":
	{
		"type":"array",
		"items":{"$ref":"#/mcq_option"},
		"minItems":1
	},

	"mcq_question":
	{
		"properties":
		{
			"type":{"enum":["mcq","mmcq"]},
			"correct_options":{"$ref":"#/mcq_options_list"},
			"options":{"$ref":"#/mcq_options_list"},
			"wrong_options":{"$ref":"#/mcq_options_list"},
			"multicorrect":{"type":"boolean"}
		},
		"oneOf":
		[
			{"required":["options"]},
			{"required":["correct_options"]}
		]
	},

	"text_question":
	{
		"properties":
		{
			"type":{"enum":["text","regex"]},
			"answer":{"type":"string"},
			"ignore_case":{"type":"boolean"},
			"use_regex":{"type":"boolean"}
		},
		"required":["answer"]
	},

	"int_question":
	{
		"properties":
		{
			"type":{"enum":["int"]},
			"min_allowed":{"type":"integer"},
			"max_allowed":{"type":"integer"},
			"answer":{"type":"integer"},
			"min_answer":{"type":"integer"},
			"max_answer":{"type":"integer"},
			"step":{"type":"integer"}
		},
		"oneOf":
		[
			{"required":["answer"]},
			{"required":["min_answer","max_answer"]}
		],
		"dependencies":
		{"step":["min_answer"]}
	},

	"float_question":
	{
		"properties":
		{
			"type":{"enum":["float"]},
			"answer":{"type":"number"},
			"accuracy":{"type":"number"}
		},
		"required":["answer"]
	},

	"bool_question":
	{
		"properties":
		{
			"type":{"enum":["bool"]},
			"answer":{"type":"boolean"}
		},
		"required":["answer"]
	},

	"question":
	{
		"$schema": "http://json-schema.org/schema#",
		"title":"question",
		"type":"object",
		"properties":
		{
			"title":{"type":"string"},
			"text":{"type":"string"},
			"hint":{"type":"string"},
			"comment":{"type":"string"},
			"type":{"type":"string"},
			"tags":{"$ref":"#/tag_list"}
		},
		"required":["type"],
		"oneOf":
		[
			{"$ref":"#/mcq_question"},
			{"$ref":"#/text_question"},
			{"$ref":"#/int_question"},
			{"$ref":"#/float_question"},
			{"$ref":"#/bool_question"},
			{
				"properties":
				{
					"type":{"not":{"enum":["mcq","mmcq","text","regex","int","float","bool"]}}
				}
			}
		]
	},

	"section":
	{
		"$schema": "http://json-schema.org/schema#",
		"title":"section",
		"type":"object",
		"properties":
		{
			"name":{"type":"string"},
			"info":{"type":"string"},
			"comment":{"type":"string"},
			"tags":{"$ref":"#/tag_list"},
			"questions":
			{
				"type":"array",
				"items":
				{
					"anyOf":
					[
						{"$ref":"#/pointer"},
						{"$ref":"#/question"}
					]
				}
			},
			"allowed_attempts":
			{"type":"integer","minimum":0},
			"show_correct_answer":{"type":"boolean"},
			"max_questions_to_attempt":
			{"type":"integer","minimum":0},
			"marking_scheme":
			{
				"type":"object",
				"properties":
				{
					"correct":{"type":"integer"},
					"wrong":{"type":"integer"},
					"na":{"type":"integer"},
					"hint_deduction":{"type":"integer"}
				}
			},
			"unlock":
			{
				"type":"object",
				"properties":
				{
					"marks":{"type":"integer"},
					"questions":
					{"type":"integer","minimum":0},
					"both_needed":{"type":"boolean"}
				}
			},
			"shuffle":
			{
				"properties":
				{
					"options":{"type":"boolean"},
					"questions":{"type":"boolean"}
				}
			}
		},
		"required":["name"]
	},

	"exam":
	{
		"$schema": "http://json-schema.org/schema#",
		"title":"exam",
		"type":"object",
		"properties":
		{
			"name":{"type":"string"},
			"info":{"type":"string"},
			"comment":{"type":"string"},
			"tags":{"$ref":"#/tag_list"},
			"author":{"type":"string"},
			"sections":
			{
				"type":"array",
				"items":
				{
					"anyOf":
					[
						{"$ref":"#/pointer"},
						{"$ref":"#/section"}
					]
				}
			},
			"time_limit":
			{"type":"integer","minimum":0},
			"shuffle_sections":{"type":"boolean"}
		},
		"required":["name"]
	},

	"$ref":"#/always_mismatch"
}
